# ç¾¤çµ„æ‘˜è¦ç‹ v3 

ç¾¤çµ„æ‘˜è¦ç‹ v3 æ˜¯ä¸€æ¬¾ä½¿ç”¨ FastAPIã€LINE Messaging API å’Œ Google Generative AIï¼Œä¾†ç‚º LINE ç¾¤çµ„çš„è¨Šæ¯é€²è¡Œæ‘˜è¦çš„é–‹æºå°ˆæ¡ˆã€‚

è‹¥ä½ ä¸æƒ³æ¶è¨­ LineBot , å¯ä»¥å…è²»ä½¿ç”¨æˆ‘çš„æœå‹™ 

Line @377mwhqu


## ğŸ†• ç‰ˆæœ¬æ›´æ–°

### v3.2 (2025-11-23)
- âœ… ä¿®æ­£åœ–ç‰‡ç”Ÿæˆæ¨¡å‹åƒæ•¸åŒ–å•é¡Œ
  - ç§»é™¤ç¡¬ç·¨ç¢¼çš„æ¨¡å‹åç¨±
  - ç¾åœ¨æ­£ç¢ºä½¿ç”¨ç’°å¢ƒè®Šæ•¸ `GEMINI_IMAGE_MODEL` è¨­å®š
  - æ”¯æ´ä½¿ç”¨ `gemini-3-pro-image-preview` ç­‰æ–°æ¨¡å‹
- âš ï¸ **é‡è¦**ï¼šæ›´æ–°ç¨‹å¼ç¢¼å¾Œéœ€è¦é‡æ–°å»ºç½®ä¸¦éƒ¨ç½² Docker å®¹å™¨æ‰èƒ½ç”Ÿæ•ˆ

### v3.1 (2025-08-15)
- âœ… æ–°å¢ AI å•ç­”æ¨¡å¼ï¼ˆ@ æ©Ÿå™¨äººåŠŸèƒ½ï¼‰
- âœ… æ–°å¢å¹«åŠ©ç³»çµ± (!help)
- âœ… æ”¹é€²å¤šç¾¤çµ„æ”¯æ´æ©Ÿåˆ¶
- âœ… æ¨¡å‹åƒæ•¸åŒ– (GEMINI_MODEL)
- âœ… å¤§å°å¯«ä¸æ•æ„ŸæŒ‡ä»¤æª¢æ¸¬
- âœ… æ”¯æ´ä¸­è‹±æ–‡æŒ‡ä»¤ç¬¦è™Ÿ



## ğŸ“š ç›®éŒ„

- [åŠŸèƒ½](#åŠŸèƒ½)
- [ğŸ†• æœ€æ–°åŠŸèƒ½](#-æœ€æ–°åŠŸèƒ½)
- [æŒ‡ä»¤åˆ—è¡¨](#æŒ‡ä»¤åˆ—è¡¨)
- [æµç¨‹åœ–](#æµç¨‹åœ–)
- [é–‹å§‹ä½¿ç”¨](#é–‹å§‹ä½¿ç”¨)
- [Docker éƒ¨ç½²](#docker-éƒ¨ç½²)
- [å¤šç¾¤çµ„æ”¯æ´èªªæ˜](./MULTI_GROUP_SUPPORT.md)

> é»å­ä¾†è‡ªï¼šã€Œ[å¦‚ä½•é–‹ç™¼ä¸€å€‹ã€ŒLINE Bot ç¾¤çµ„èŠå¤©æ‘˜è¦ç”Ÿæˆå™¨](https://engineering.linecorp.com/zh-hant/blog/linebot-chatgpt)ã€

> æœ€åŸå§‹ä»£ç¢¼ ä¾†è‡ª https://github.com/louis70109/linebot-gemini-summarize.git  æ„Ÿè¬åŸä½œè€…



## åŠŸèƒ½

- æ¥æ”¶ LINE ç¾¤çµ„ä¸­çš„è¨Šæ¯
- é€éå‘½ä»¤æ¸…ç©ºå°è©±æ­·å²ç´€éŒ„
- é€éå‘½ä»¤ç”¢ç”Ÿè¨Šæ¯çš„æ‘˜è¦
- **AI å•ç­”æ¨¡å¼**ï¼š@ æ©Ÿå™¨äººé€²è¡Œä¸€æ¬¡æ€§å•ç­”
- **ç¾¤çµ„æ™ºæ…§å›æ‡‰**ï¼šåœ¨ç¾¤çµ„ä¸­åªæœ‰è¢« @ æåŠæˆ–ä½¿ç”¨ç‰¹æ®ŠæŒ‡ä»¤æ™‚æ‰æœƒå›æ‡‰

### ç¾¤çµ„å›æ‡‰è¦å‰‡

- **ç§äººè¨Šæ¯**ï¼šBot æœƒå›æ‡‰æ‰€æœ‰è¨Šæ¯
- **ç¾¤çµ„è¨Šæ¯**ï¼š
  - **ç²¾ç¢º @ æåŠ**ï¼šé€²å…¥ AI å•ç­”æ¨¡å¼ï¼ˆä¸€æ¬¡æ€§å›ç­”ï¼Œä¸è¨˜éŒ„åˆ°å°è©±æ­·å²ï¼‰
    - `@377mwhqu ä½ å¥½` - ä½¿ç”¨å®˜æ–¹ ID
    - `@Bot ä»€éº¼æ˜¯ AIï¼Ÿ` - ä½¿ç”¨é—œéµè©ï¼ˆéœ€è¦çœŸæ­£çš„ mentionï¼‰
    - `@æ©Ÿå™¨äºº å¹«æˆ‘è§£é‡‹` - ä½¿ç”¨ä¸­æ–‡é—œéµè©ï¼ˆéœ€è¦çœŸæ­£çš„ mentionï¼‰
  - **ç‰¹æ®ŠæŒ‡ä»¤**ï¼š
    - `!æ¸…ç©º` æˆ– `ï¼æ¸…ç©º` `ï¼clean` - æ¸…ç©ºå°è©±æ­·å²ç´€éŒ„
    - `!æ‘˜è¦` æˆ– `ï¼æ‘˜è¦` `ï¼ç¸½çµ` `ï¼summary` - ç”¢ç”Ÿè¨Šæ¯æ‘˜è¦
    - `!help` æˆ– `!å¹«åŠ©` - é¡¯ç¤ºä½¿ç”¨èªªæ˜
  - å…¶ä»–æƒ…æ³ä¸‹ä¸æœƒå›æ‡‰ï¼Œä½†æœƒè¨˜éŒ„è¨Šæ¯ä¾›æ‘˜è¦åŠŸèƒ½ä½¿ç”¨

### åŠŸèƒ½ç‰¹è‰²

- **æ™ºæ…§è¨˜éŒ„**ï¼šæ‰€æœ‰ç¾¤çµ„è¨Šæ¯éƒ½æœƒè¢«è¨˜éŒ„ï¼Œä½†ä¸æœƒç”¢ç”Ÿå›æ‡‰æ‰“æ“¾ç¾¤çµ„å°è©±
- **AI å•ç­”**ï¼šé€é @ æåŠå¯ä»¥å¿«é€Ÿç²å¾— AI å›ç­”ï¼Œä¸æœƒå½±éŸ¿å°è©±æ­·å²
- **æ‘˜è¦åŠŸèƒ½**ï¼šåŸºæ–¼è¨˜éŒ„çš„è¨Šæ¯ç”¢ç”Ÿå°è©±æ‘˜è¦
- **å½ˆæ€§é…ç½®**ï¼šæ”¯æ´ä¸­è‹±æ–‡æŒ‡ä»¤ç¬¦è™Ÿï¼ˆ`!` å’Œ `ï¼`ï¼‰

## ğŸ†• æœ€æ–°åŠŸèƒ½

### 1. ç²¾ç¢º AI å•ç­”æ¨¡å¼
åœ¨ç¾¤çµ„ä¸­ç²¾ç¢º @ æ©Ÿå™¨äººå³å¯é€²è¡Œä¸€æ¬¡æ€§å•ç­”ï¼š
```
@377mwhqu ä»€éº¼æ˜¯æ¢¯åº¦ä¸‹é™ï¼Ÿ     # ä½¿ç”¨å®˜æ–¹ IDï¼ˆæ¨è–¦ï¼‰
@Bot Python æ€éº¼å­¸ï¼Ÿ          # ä½¿ç”¨é—œéµè© + mention
@æ©Ÿå™¨äºº è«‹å¹«æˆ‘è§£é‡‹ AI          # ä½¿ç”¨ä¸­æ–‡é—œéµè© + mention
```
- âœ… ç²¾ç¢ºæª¢æ¸¬ï¼šé¿å…èª¤è§¸ç™¼ï¼ˆå¦‚ `@john` ä¸æœƒè§¸ç™¼ Botï¼‰
- âœ… ä¸€æ¬¡æ€§å›ç­”ï¼Œå•å®Œå°±çµæŸ
- âœ… ä¸è¨˜éŒ„åˆ°å°è©±æ­·å²ï¼ˆé¿å…å½±éŸ¿æ‘˜è¦ï¼‰
- âœ… è‡ªå‹•ä½¿ç”¨ç¹é«”ä¸­æ–‡å›ç­”
- âœ… æ”¯æ´å®˜æ–¹ ID å’Œé—œéµè©æª¢æ¸¬

### 2. å¹«åŠ©ç³»çµ±
ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤ç²å¾—å®Œæ•´æ“ä½œèªªæ˜ï¼š
```
!help
!å¹«åŠ©
ï¼help
ï¼å¹«åŠ©
```

### 3. å¤šç¾¤çµ„æ”¯æ´
- âœ… æ”¯æ´åŒæ™‚åœ¨å¤šå€‹ç¾¤çµ„é‹ä½œ
- âœ… æ¯å€‹ç¾¤çµ„çš„å°è©±è¨˜éŒ„å®Œå…¨åˆ†é›¢
- âœ… æ‘˜è¦å’Œæ¸…ç©ºæŒ‡ä»¤åªå½±éŸ¿ç•¶å‰ç¾¤çµ„
- âœ… ç§äººå°è©±èˆ‡ç¾¤çµ„å°è©±åˆ†é–‹å„²å­˜

ğŸ‘‰ **è©³ç´°çš„å¤šç¾¤çµ„æ©Ÿåˆ¶èªªæ˜**ï¼š[MULTI_GROUP_SUPPORT.md](./MULTI_GROUP_SUPPORT.md)

### 4. æ”¹é€²çš„æŒ‡ä»¤ç³»çµ±
- âœ… å¤§å°å¯«ä¸æ•æ„Ÿçš„æŒ‡ä»¤æª¢æ¸¬
- âœ… æ”¯æ´ä¸­è‹±æ–‡æŒ‡ä»¤ç¬¦è™Ÿï¼ˆ`!` å’Œ `ï¼`ï¼‰
- âœ… æ›´æ¸…æ™°çš„ä½¿ç”¨èªªæ˜

## æŒ‡ä»¤åˆ—è¡¨

| æŒ‡ä»¤ | åŠŸèƒ½ | é©ç”¨ç¯„åœ |
|------|------|---------|
| `@Bot [å•é¡Œ]` | AI å•ç­”æ¨¡å¼ | ç¾¤çµ„ |
| `!æ‘˜è¦` / `ï¼æ‘˜è¦` | ç”¢ç”Ÿå°è©±æ‘˜è¦ | ç¾¤çµ„ã€ç§äºº |
| `!æ¸…ç©º` / `ï¼æ¸…ç©º` | æ¸…ç©ºå°è©±è¨˜éŒ„ | ç¾¤çµ„ã€ç§äºº |
| `!help` / `!å¹«åŠ©` | é¡¯ç¤ºä½¿ç”¨èªªæ˜ | ç¾¤çµ„ã€ç§äºº |
| ç›´æ¥è¨Šæ¯ | ä¸€èˆ¬ AI å°è©± | ç§äºº |

## æµç¨‹åœ–

```
   â”Œâ”€â”
   â•‘"â”‚
   â””â”¬â”˜
   â”Œâ”¼â”
    â”‚            â”Œâ”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”
   â”Œâ”´â”           â”‚Groupâ”‚          â”‚Webhook_Serverâ”‚               â”‚Firebaseâ”‚          â”‚Geminiâ”‚
  User           â””â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”˜
   â”‚    å‚³é€æ–‡ç« è¨Šæ¯  â”‚                    â”‚                           â”‚                  â”‚
   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                           â”‚                  â”‚
   â”‚                â”‚     å‚³é€ç”¨æˆ¶æŒ‡ä»¤     â”‚                           â”‚                  â”‚
   â”‚                â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                           â”‚                  â”‚
   â”‚                â”‚                    â”‚   å„²å­˜èŠå¤©ç‹€æ…‹åœ¨ Realtime DBâ”‚                  â”‚
   â”‚                â”‚                    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> |                 â”‚
   â”‚                â”‚                    â”‚           å„²å­˜å®Œç•¢         â”‚                  â”‚
   â”‚                â”‚                    â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ |                  â”‚
   â”‚                â”‚    å›å‚³å·²å®Œæˆæ–‡å­—    â”‚                           â”‚                  â”‚
   â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                           â”‚                  â”‚
   â”‚   è¼¸å…¥ "!æ‘˜è¦"  â”‚                    â”‚                           â”‚                  â”‚
   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                           â”‚                  â”‚
   â”‚                â”‚     å‚³é€ç”¨æˆ¶æŒ‡ä»¤     â”‚                           â”‚                  â”‚
   â”‚                â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                           â”‚                  â”‚
   â”‚                â”‚                    â”‚          æŠ“å–èŠå¤©è¨˜éŒ„       â”‚                  â”‚
   â”‚                â”‚                    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> |                  â”‚
   â”‚                â”‚                    â”‚           å›å‚³æ¸…å–®         â”‚                  â”‚
   â”‚                â”‚                    â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€|                  â”‚
   â”‚                â”‚                    â”‚               ä¸‹prompt é€²è¡Œæ‘˜è¦é‹ç®—            â”‚
   â”‚                â”‚                    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>|
   â”‚                â”‚                    â”‚                   å›å‚³æ‘˜è¦æ¸…å–®                 â”‚
   â”‚                â”‚                    â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€|
   â”‚                â”‚   å›å‚³æ‘˜è¦è³‡è¨Šè‡³ç¾¤çµ„  â”‚                           â”‚                  â”‚
   â”‚                â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                           â”‚                  â”‚
  User           â”Œâ”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”
   â”Œâ”€â”           â”‚Groupâ”‚          â”‚Webhook_Serverâ”‚               â”‚Firebaseâ”‚          â”‚Geminiâ”‚
   â•‘"â”‚           â””â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”˜
   â””â”¬â”˜
   â”Œâ”¼â”
    â”‚
   â”Œâ”´â”
```

## ä½¿ç”¨èªªæ˜

### åŸºæœ¬æŒ‡ä»¤

#### ç§äººå°è©±
åœ¨èˆ‡ Bot çš„ç§äººå°è©±ä¸­ï¼Œç›´æ¥ç™¼é€ä»»ä½•è¨Šæ¯å³å¯ç²å¾— Gemini AI çš„å›æ‡‰ã€‚

#### ç¾¤çµ„å°è©±
åœ¨ç¾¤çµ„ä¸­ï¼ŒBot åªæœƒåœ¨ä»¥ä¸‹æƒ…æ³å›æ‡‰ï¼š

1. **@ æåŠ Bot**
   ```
   @BotName è«‹å•ä»Šå¤©å¤©æ°£å¦‚ä½•ï¼Ÿ
   ```

2. **ä½¿ç”¨ç‰¹æ®ŠæŒ‡ä»¤**
   - `!æ¸…ç©º` æˆ– `ï¼æ¸…ç©º` - æ¸…ç©ºç•¶å‰å°è©±çš„æ­·å²ç´€éŒ„
   - `!æ‘˜è¦` æˆ– `ï¼æ‘˜è¦` - å°ç›®å‰çš„å°è©±å…§å®¹ç”Ÿæˆæ‘˜è¦

### ä½¿ç”¨ç¯„ä¾‹

#### ç¾¤çµ„å°è©±ç¯„ä¾‹ï¼š
```
ç”¨æˆ¶A: ä»Šå¤©è¦è¨è«–å°ˆæ¡ˆé€²åº¦
ç”¨æˆ¶B: æˆ‘é€™é‚Šå·²ç¶“å®Œæˆäº†å‰ç«¯è¨­è¨ˆ
ç”¨æˆ¶C: @BotName è«‹ç¸½çµä¸€ä¸‹æˆ‘å€‘çš„è¨è«–
Bot: æ ¹æ“šæ‚¨çš„è¨è«–ï¼Œä¸»è¦é€²åº¦å¦‚ä¸‹ï¼š...

ç”¨æˆ¶A: !æ‘˜è¦
Bot: ä»¥ä¸‹æ˜¯å°è©±æ‘˜è¦ï¼š
â€¢ è¨è«–å°ˆæ¡ˆé€²åº¦
â€¢ å‰ç«¯è¨­è¨ˆå·²å®Œæˆ
â€¢ ...
```

#### æ¸…ç©ºæ­·å²ç´€éŒ„ï¼š
```
ä»»ä½•ç”¨æˆ¶: !æ¸…ç©º
Bot: ------å°è©±æ­·å²ç´€éŒ„å·²ç¶“æ¸…ç©º------
```

## é–‹å§‹ä½¿ç”¨

### ç’°å¢ƒè®Šæ•¸

åœ¨é–‹å§‹ä¹‹å‰ï¼Œæ‚¨éœ€è¦è¨­å®šä»¥ä¸‹ç’°å¢ƒè®Šæ•¸ï¼š

- `LINE_CHANNEL_SECRET`: æ‚¨çš„ LINE Bot Channel å¯†é‘°
- `LINE_CHANNEL_ACCESS_TOKEN`: æ‚¨çš„ LINE Bot Channel ä»¤ç‰Œ
- `LINE_BOT_ID`: æ‚¨çš„ LINE Bot å®˜æ–¹ IDï¼ˆå¯é¸ï¼‰
  - é è¨­å€¼: `377mwhqu`
  - ç”¨æ–¼ç²¾ç¢ºæª¢æ¸¬ @ æåŠï¼Œé¿å…èª¤è§¸ç™¼
- `FIREBASE_URL`: æ‚¨çš„ Firebase è³‡æ–™åº« URL
  - Example: https://OOOXXX.firebaseio.com/
- `GEMINI_API_KEY`: æ‚¨çš„ Gemini API é‡‘é‘°
- `GEMINI_MODEL`: ä½¿ç”¨çš„ Gemini æ¨¡å‹ï¼ˆå¯é¸ï¼‰
  - é è¨­å€¼: `gemini-2.5-flash`
  - å…¶ä»–é¸é …: `gemini-1.5-flash`, `gemini-1.5-pro` ç­‰

#### åœ–ç‰‡ç”Ÿæˆç›¸é—œç’°å¢ƒè®Šæ•¸ï¼ˆv3.2+ï¼‰

- `GEMINI_IMAGE_API_KEY`: åœ–ç‰‡ç”Ÿæˆå°ˆç”¨çš„ Gemini API é‡‘é‘°ï¼ˆå¯é¸ï¼‰
  - å¦‚æœªè¨­å®šï¼Œå°‡ä½¿ç”¨ `GEMINI_API_KEY`
- `GEMINI_IMAGE_MODEL`: åœ–ç‰‡ç”Ÿæˆä½¿ç”¨çš„æ¨¡å‹ï¼ˆå¯é¸ï¼‰
  - é è¨­å€¼: `gemini-3-pro-image-preview`
  - å…¶ä»–é¸é …: `gemini-2.5-flash-image-preview`
  - **æ³¨æ„**ï¼šæ­¤ç’°å¢ƒè®Šæ•¸æœƒå½±éŸ¿åœ–ç‰‡ç”Ÿæˆçš„æ¨¡å‹é¸æ“‡
- `GCS_BUCKET_NAME`: Google Cloud Storage bucket åç¨±ï¼ˆåœ–ç‰‡ç”Ÿæˆå¿…é ˆï¼‰
- `GOOGLE_APPLICATION_CREDENTIALS`: GCS èªè­‰æª”æ¡ˆè·¯å¾‘ï¼ˆåœ–ç‰‡ç”Ÿæˆå¿…é ˆï¼‰

#### å…¶ä»–ç’°å¢ƒè®Šæ•¸

- `GEMINI_LLM_API_KEY`: æ–‡å­—å°è©±å°ˆç”¨çš„ Gemini API é‡‘é‘°ï¼ˆå¯é¸ï¼‰
  - å¦‚æœªè¨­å®šï¼Œå°‡ä½¿ç”¨ `GEMINI_API_KEY`
- `GEMINI_LLM_MODEL`: æ–‡å­—å°è©±ä½¿ç”¨çš„æ¨¡å‹ï¼ˆå¯é¸ï¼‰
  - é è¨­å€¼: `gemini-flash-latest`
  - å…¶ä»–é¸é …: `gemini-1.5-flash`, `gemini-1.5-pro` ç­‰
  - å…¶ä»–é¸é …: `gemini-1.5-flash`, `gemini-1.5-pro` ç­‰

å¦‚æœæ‚¨ä¸åœ¨ç”Ÿç”¢ç’°å¢ƒï¼Œè«‹ä½¿ç”¨ `.env` æª”æ¡ˆä¾†è¨­å®šé€™äº›è®Šæ•¸ã€‚

### LINE Webhook URL è¨­å®š

æœ¬å°ˆæ¡ˆçš„ LINE Bot callback URL ç«¯é»ç‚ºï¼š

**è·¯ç”±ç«¯é»ï¼š** `/webhooks/line`  
**HTTP æ–¹æ³•ï¼š** POST

å®Œæ•´çš„ callback URL æ ¼å¼ï¼š
```
https://ä½ çš„åŸŸå/webhooks/line
```

#### è¨­å®šæ–¹æ³•ï¼š

1. **æœ¬åœ°é–‹ç™¼ç’°å¢ƒï¼š**
   ```
   http://localhost:8080/webhooks/line
   ```
   ï¼ˆéœ€è¦ä½¿ç”¨ ngrok ç­‰å·¥å…·è®“ LINE èƒ½å­˜å–ï¼‰

2. **éƒ¨ç½²ç’°å¢ƒï¼š**
   ```
   https://ä½ çš„ç¶²åŸŸåç¨±/webhooks/line
   ```

#### å¦‚ä½•è¨­å®šï¼š

**æ–¹æ³•ä¸€ï¼šä½¿ç”¨æä¾›çš„è…³æœ¬**
```bash
./change_bot_url.sh YOUR_CHANNEL_ACCESS_TOKEN https://ä½ çš„åŸŸå/webhooks/line
```

**æ–¹æ³•äºŒï¼šæ‰‹å‹•åœ¨ LINE Developers Console è¨­å®š**
1. ç™»å…¥ [LINE Developers Console](https://developers.line.biz/)
2. é¸æ“‡ä½ çš„ Bot
3. é€²å…¥ Messaging API è¨­å®š
4. åœ¨ "Webhook URL" æ¬„ä½å¡«å…¥ï¼š`https://ä½ çš„åŸŸå/webhooks/line`
5. å•Ÿç”¨ "Use webhook"

### Docker éƒ¨ç½²

#### å»ºç«‹ Docker Image

```bash
# å»ºç«‹ Docker image
docker build -t linebot-gemini-summarize .
```

#### åŸ·è¡Œ Docker Container

**æ–¹æ³•ä¸€ï¼šç›´æ¥è¨­å®šç’°å¢ƒè®Šæ•¸**
```bash
# åŸ·è¡Œå®¹å™¨ï¼ˆéœ€è¦è¨­å®šç’°å¢ƒè®Šæ•¸ï¼‰
docker run -p 8080:8080 \
  -e LINE_CHANNEL_SECRET=ä½ çš„_LINE_CHANNEL_SECRET \
  -e LINE_CHANNEL_ACCESS_TOKEN=ä½ çš„_LINE_CHANNEL_ACCESS_TOKEN \
  -e FIREBASE_URL=ä½ çš„_FIREBASE_URL \
  -e GEMINI_API_KEY=ä½ çš„_GEMINI_API_KEY \
  -e PORT=8080 \
  linebot-gemini-summarize
```

**æ–¹æ³•äºŒï¼šä½¿ç”¨ .env æª”æ¡ˆï¼ˆæ¨è–¦ï¼‰**
```bash
# å‰µå»º .env æª”æ¡ˆ
cat > .env << EOF
LINE_CHANNEL_SECRET=ä½ çš„_LINE_CHANNEL_SECRET
LINE_CHANNEL_ACCESS_TOKEN=ä½ çš„_LINE_CHANNEL_ACCESS_TOKEN
FIREBASE_URL=ä½ çš„_FIREBASE_URL
GEMINI_API_KEY=ä½ çš„_GEMINI_API_KEY
GEMINI_IMAGE_MODEL=gemini-3-pro-image-preview
GCS_BUCKET_NAME=ä½ çš„_GCS_BUCKET_NAME
GOOGLE_APPLICATION_CREDENTIALS=/app/ä½ çš„èªè­‰æª”æ¡ˆ.json
PORT=8080
API_ENV=production
EOF
```
# ä½¿ç”¨ .env æª”æ¡ˆåŸ·è¡Œå®¹å™¨
docker run -d -p 8080:8080 --env-file .env --restart unless-stopped linebot-gemini-summarize 

# 1. åœæ­¢ä¸¦åˆªé™¤èˆŠå®¹å™¨
docker stop <container_name>
docker rm <container_name>

# 2. é‡æ–°å»ºç½®æ˜ åƒæª”
docker build -t linebot-gemini .



docker run -d \
  --env-file .env \
  -p 8080:8080 \
  --name LINE-377mwhqu \
  linebot-gemini


  docker run -d \
  --env-file .env2 \
  -p 8081:8080 \
  --name LINE-113huwec \
  linebot-gemini

```

**âš ï¸ é‡è¦æé†’ï¼šæ›´æ–°ç¨‹å¼ç¢¼å¾Œçš„éƒ¨ç½²æ­¥é©Ÿ**

å¦‚æœæ‚¨ä¿®æ”¹äº†ç¨‹å¼ç¢¼ï¼ˆå¦‚æ›´æ–°æ¨¡å‹è¨­å®šï¼‰ï¼Œéœ€è¦é‡æ–°å»ºç½®ä¸¦éƒ¨ç½²ï¼š

```bash
# 1. åœæ­¢ä¸¦ç§»é™¤èˆŠå®¹å™¨
docker stop <container_name>
docker rm <container_name>

# 2. é‡æ–°å»ºç½® image
docker build -t linebot-gemini-summarize .

# 3. ä½¿ç”¨æ–°çš„ image å•Ÿå‹•å®¹å™¨
docker run -d -p 8080:8080 --env-file .env --restart unless-stopped linebot-gemini-summarize
```

#### ä½¿ç”¨ Docker Composeï¼ˆæ¨è–¦ï¼‰

å»ºç«‹ `docker-compose.yml` æª”æ¡ˆï¼š
```yaml
version: '3.8'
services:
  linebot:
    build: .
    ports:
      - "8080:8080"
    environment:
      - LINE_CHANNEL_SECRET=ä½ çš„_LINE_CHANNEL_SECRET
      - LINE_CHANNEL_ACCESS_TOKEN=ä½ çš„_LINE_CHANNEL_ACCESS_TOKEN
      - FIREBASE_URL=ä½ çš„_FIREBASE_URL
      - GEMINI_API_KEY=ä½ çš„_GEMINI_API_KEY
      - GEMINI_MODEL=gemini-2.5-flash
      - GEMINI_IMAGE_MODEL=gemini-3-pro-image-preview
      - GCS_BUCKET_NAME=ä½ çš„_GCS_BUCKET_NAME
      - GOOGLE_APPLICATION_CREDENTIALS=/app/ä½ çš„èªè­‰æª”æ¡ˆ.json
      - PORT=8080
      - API_ENV=production
```

ç„¶å¾ŒåŸ·è¡Œï¼š
```bash
# é¦–æ¬¡éƒ¨ç½²æˆ–æ›´æ–°ç¨‹å¼ç¢¼å¾Œ
docker-compose up -d --build

# åƒ…é‡å•Ÿæœå‹™ï¼ˆæœªæ›´æ”¹ç¨‹å¼ç¢¼æ™‚ï¼‰
docker-compose restart
```

## ğŸ“– é€²éšæ–‡ä»¶

### å¤šç¾¤çµ„æ”¯æ´æ©Ÿåˆ¶
è©³ç´°äº†è§£ Bot å¦‚ä½•åœ¨å¤šå€‹ç¾¤çµ„ä¸­é‹ä½œï¼Œä»¥åŠè³‡æ–™åˆ†é›¢æ©Ÿåˆ¶ï¼š

ğŸ‘‰ **[å¤šç¾¤çµ„æ”¯æ´èªªæ˜æ–‡ä»¶](./MULTI_GROUP_SUPPORT.md)**


## ğŸ¤ è²¢ç»

æ­¡è¿æäº¤ Issue å’Œ Pull Requestï¼


